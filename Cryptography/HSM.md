# HSM(Hardware Security Module)
> μ •μ, κ΄€λ ¨ μ¤ν” μ†μ¤ λ¶„μ„ μ§„ν–‰π“


## κ°λ…
+ μ•”νΈν‚¤λ¥Ό μ•μ „ν•κ² μ €μ¥ν•κ³ , λ¬Όλ¦¬μ /λ…Όλ¦¬μ μΌλ΅ λ³΄νΈν•λ” μ—­ν• μ„ μν–‰ν•λ” ν•λ“μ›¨μ–΄ μ¥μΉ
+ κ΄€λ ¨μΈμ¦ : FIPS 140-2
   + Leve 1
     + κΈ°λ³Έμ μΈ λ³΄μ• μ”κµ¬μ‚¬ν•­μ— λ€ν• ν‰κ°€
     + λ¬Όλ¦¬μ  λ³΄μ•μ„±μ— λ€ν•΄μ„λ” μ”κµ¬λμ§€ μ•κ³ , μ£Όλ΅ μ†ν”„νΈμ›¨μ–΄μ  μ•”νΈν™” λ¨λ“μ— λ€ν• ν‰κ°€μ„
   + **Level 2**
     + μ•”νΈν™” λ¨λ“ λΏ μ•„λ‹λΌ ν•λ“μ›¨μ–΄μ  λ¶€λ¬Έμ—μ„ λ³΄μ• μ ν•©μ„± ν‰κ°€ μ‹¤μ‹
     + λ¬Όλ¦¬μ μΈ μ¥λΉ„ ν•΄μ²΄ λ°©μ§€ λ“±μ— λ€ν• λ€μ±…μ΄ κ°•κµ¬λμ–΄μ•Ό ν•¨
   + **Level 3**
     + μ ν’ λ¶„ν•΄λ¥Ό λ§‰κΈ° μ„ν• λ‹¨νΈμ  λ°©νΈ λΏ μ•„λ‹λΌ μ κ·Ήμ μΈ λ€μ±…κΉμ§€ μ μ‹λλ” μ§€ ν‰κ°€
     + λ¬΄λ‹¨ μ ‘κ·Όκ³Ό κ°™μ΄ λ¶€λ‹Ήν• λ°©λ²•μ λ³€κ²½ λλ” μ¤μ© κ°μ§€ μ‹ ν•΄λ‹Ή μμΉλ” μ£Όμ” λ³΄μ• λ³€μλ¥Ό μ‚­μ 
  + Level 4
     + λ¬Όλ¦¬μ μΈ λ³΄νΈκ°€ μ–΄λ ¤μ΄ ν™κ²½μ„ κ³ λ ¤ν•΄ ν‰κ°€
     + ν΄λΌμ°λ“ λ“± μƒλ΅μ΄ ν‚¤ κ΄€λ¦¬ μ„λΉ„μ¤λ‚ μ ν’μ— μ μ©ν•κΈ° μ„ν• λ λ²¨
       
## νΉμ§•
+ μ•”νΈν‚¤λ¥Ό HSM λ‚΄λ¶€μ— μ €μ¥ν•μ—¬, μ•μ „ν•κ² κ΄€λ¦¬ν•λ” μ—­ν• μ„ μν–‰
+ λ‚΄λ¶€μ μΌλ΅ ν‚¤λ¥Ό κ΄€λ¦¬ν•κ³ , μ•”νΈ μ—°μ‚° μμ²΄λ¥Ό λ‚΄λ¶€μ—μ„ μν–‰(μ™Έλ¶€ μ μ¶ X)
 
## κ΄€λ ¨ μ¤ν” μ†μ¤
### SoftHSM v2
+ κ°λ… : PKCS#11 κΈ°λ¥μ„ μ†ν”„νΈμ›¨μ–΄λ΅ κµ¬ν„ν• μ¤ν”μ†μ¤ ν”„λ΅κ·Έλ¨
  + PKCS#11
    + Cryptographic Token Interface Standard λ΅ μ•”νΈ μ„λΉ„μ¤λ¥Ό μ κ³µν•λ” ν‘μ¤€ API μ •μ
    + Cλ¥Ό μ‚¬μ©ν•λ” ANSI C ν•¨μμ μ •μ
    + μ •μλ ν•¨μλ“¤μ„ Cryptoki λΌλ” λ™μ  λΌμ΄λΈλ¬λ¦¬μ— λ§λ“λ” κ²ƒμ— λ€ν• ν‘μ¤€ κΈ°μ μ„
    
+ νΉμ§•
  + OpenDNSSEC ν”„λ΅μ νΈμ μΌλ¶€λ΅ μ¤ν”μ†μ¤μ„
    + PKCS#11 μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ•”νΈν™” ν‚¤λ¥Ό μ²λ¦¬ν•κ³  μ €μ¥ν•¨
    + HSM μ‹λ®¬λ μ΄ν„°λ΅, μ΄λ¥Ό ν†µν•΄ μ•”νΈν™” ν‚¤ λ° λ³΄μ• κ΄€λ ¨ μ‘μ—…μ„ μ‹λ®¬λ μ΄μ… ν•  μ μμ
  + μ•”νΈν™” λΌμ΄λΈλ¬λ¦¬ Botan λλ” OpenSSLμ— μμ΅΄μ„± μ΅΄μ¬
    + Botan 2.0.0 : C++λ΅ μ‘μ„±λ μ¤ν”μ†μ¤ λΌμ΄λΈλ¬λ¦¬λ΅, μ•”νΈν™” λ° ν”„λ΅ν† μ½ λ“±μ„ μ§€μ›ν•λ©° λ³΄μ• μ‘μ© ν”„λ΅κ·Έλ¨μ„ κ°λ°ν•λ” λ°μ— μ‚¬μ©λ¨
    + OpenSSL 1.0.0 : Cλ΅ μ‘μ„±λ μ¤ν”μ†μ¤ λΌμ΄λΈλ¬λ¦¬λ΅, μ•”νΈν™”/λ””μ§€ν„Έμ„λ… λ° SSL/TLS ν”„λ΅ν† μ½ κµ¬ν„ λ“± λ‹¤μ–‘ν• λ³΄μ• κΈ°λ¥μ„ μ κ³µν•¨
    > Botanμ΄ μƒλ€μ μΌλ΅ λ” κ°„λ‹¨ν• μΈν„°νμ΄μ¤λ¥Ό κ°–κ³ , OpenSSLμ€ μ‚¬μ©ν•κΈ°μ— μƒλ€μ μΌλ΅ λ³µμ΅ν•κ³  λ©”λ¨λ¦¬ κ΄€λ¦¬ λ° λ²„κ·Έλ¬Έμ κ°€ μ΅΄μ¬ν•λ‹¤κ³  ν•¨
  + μ• ν”λ¦¬μΌ€μ΄μ…μ© μ¬λ΅―μ„ λ³„λ„λ΅ μƒμ„±ν•μ—¬ κ΄€λ¦¬ν•¨
    + μ¬λ΅―(slot) : λ…λ¦½λ μμ—­μΌλ΅ λ¶„λ¦¬λμ–΄μλ” λ…Όλ¦¬μ  κ°λ…μΌλ΅ λ³΄λ©΄ λ¨
    + SoftHMSμ€ HSMμ„ μ—¬λ¬ μ¬λ΅―μΌλ΅ λ‚λ”
    + κµ¬μ΅°λ” λ‹¤μκ³Ό κ°™μ
       > <img src="https://prod-files-secure.s3.us-west-2.amazonaws.com/458aaba5-6bb4-49e3-ac84-7f827aa41d9e/590c5012-a816-44f0-b5f6-3026d9381c61/Untitled.png">
       
+ μ§€μ› λ²”μ„
  + κΈ°λ³Έμ μΌλ΅ λ§μ΄ ν™μ©λλ” μ•κ³ λ¦¬μ¦μ„ μ§€μ›ν•¨
    + RSA, DES/3DES, ECC, DHKE, Hash, HMAC, Key Generation ...
   
+ μ„¤μΉ λ°©λ²•
  + μλ„μ° μ„¤μΉ : SoftHSM v2 for Windows (msi νμΌ μ„¤μΉ) ν›„ ν™κ²½λ³€μ μ„¤μ •
  + λ¦¬λ…μ¤ μ„¤μΉ : ν•λ‹¨ λ‘λ²μ§Έ github repostoryμ—μ„ λ‹¤μ΄λ΅λ“

+ μ‚¬μ© λ°©λ²•(μλ„μ° κΈ°μ¤€)
  +  λ…λ Ή ν”„λ΅¬ν”„νΈ(cmd)λ¥Ό ν†µν•΄ μ‹¤ν–‰ (softhsm2-utils.exe νμΌ ν™μ©)
  +  μ¬λ΅― μ΅°ν : `softhsm2-utils.exe --show-slots`
    + μ¶λ ¥ : μ΄μ©κ°€λ¥ν• μ¬λ΅―λ“¤μ΄ μ¶λ ¥λ¨ (μ΄κΈ°μ—λ” slot 0λ§ μ΅΄μ¬ν•¨)
  +  μ¬λ΅― μ΄κΈ°ν™” : `softhsm2-utils.exe --init-token --slot <slot_number> --label <label_name>`
    + λ…λ Ήμ–΄ μ…λ ¥ν›„, SOμ™€ Userμ— λ€ν• PIN μ„¤μ • μ§„ν–‰
      > SOλ” User PIN μ„¤μ •λ“±μ„ ν•λ” κ΄€λ¦¬μ κ³„μ •, Userλ” μΌλ° HSMμ„ μ‚¬μ©ν•λ” μ‚¬μ©μ κ³„μ •μ„ μλ―Έν•¨
    + μ¶λ ¥ : μ…λ ¥ν• λΌλ²¨/PINμΌλ΅ μ„¤μ •λ μ¬λ΅―μ„ ν¬ν•¨ν• μ¬λ΅―λ“¤μ΄ μ¶λ ¥λ¨
  + μ¬λ΅― μ‚­μ  : `softhsm2-utils.exe --delete-token --slot <slot_number>`
    + κ²°κ³Ό : μ¬λ΅―μ ν† ν°μ΄ μ‚­μ λλ©°, ν† ν° μ‚­μ  μ‹ μ¬λ΅―μ—μ„ μ €μ¥λ λ¨λ“  ν‚¤μ™€ μΈμ¦μ„ μ‚­μ λ¨  
    
  

## μ°Έκ³ 
+ [PKCS#11 κ΄€λ ¨ λ‹¤λ¥Έ μ‚¬λμ λΈ”λ΅κ·Έ π’¥](https://blog.naver.com/aepkoreanet/220754502731)
+ [HSM κ΄€λ ¨ λ‹¤λ¥Έ μ‚¬λμ λΈ”λ΅κ·Έπ](https://hyg4196.tistory.com/128)
+ [OpenDNSSEC SoftHSM v2 - Github](https://github.com/opendnssec/SoftHSMv2)
+ [OpenDNSSEC SoftHSM page](https://www.opendnssec.org/softhsm/)
  
